@model Domain.SkillMatrix
@using Domain
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>SkillMatrixView</title>
    <link rel="stylesheet" type="text/css" media="screen" href="~/Content/SkillMatrixView.css" />
    <script>
        function changePosition() {
            var dropList = document.getElementById("dropPositions");
            var selectedId = dropList.options[dropList.selectedIndex].value;
            var elements = document.getElementsByClassName("flex-container");
            for (var i = 0; i < elements.length; i++) {
                for (var j = 0; j < elements[i].children.length; j++) {
                    elements[i].children[j].style.backgroundColor = "white";
                }
            }
            if (selectedId == -1) {
                for (var i = 0; i < elements.length; i++) {
                    for (var j = 0; j < elements[i].children.length; j++) {
                        var ch = elements[i].children[j];
                        if (ch.className.endsWith("emp")) {
                            ch.style.backgroundColor = "rgba(167, 212, 123, 0.25)";
                        }
                    }
                }
            } else {
                elements = document.getElementsByClassName("pos" + selectedId);
                for (var i = 0; i < elements.length; i++) {
                    elements[i].style.backgroundColor = "rgba(167, 212, 123, 0.25)";
                }
                elements = document.getElementsByClassName("pos" + selectedId + "emp");
                for (var i = 0; i < elements.length; i++) {
                    elements[i].style.backgroundColor = "rgba(167, 212, 123, 0.25)";
                }
            }
        }
    </script>
</head>
<body>
    <script>changePosition(-1);</script>
    <div class="items-container" id="root">
        <p>SkillMatrix</p>
        <span>Display:</span><select id="dropPositions" class="prof-button" name="SpecializationId" onchange="changePosition()" autofocus>
            <option value="-1">Your skill levels</option>
            @foreach (var position in Model.Specialization.Positions)
            {
            <option value="@position.PositionId">@position.Name</option>
            }
        </select>
            @{
                foreach (var levelInMatrix in Model.SkillLevels)
                {
                    Skill skill = levelInMatrix.Skill;
                    List<Position> positions = Model.Specialization.Positions.ToList();
        <div class="flex-row" id="skill_@skill.SkillId">
            <div class="header">
                @skill.Name
            </div>
            <div class="flex-container">
                @{
        foreach (var levelInSkill in skill.SkillLevels)
        {
            string className = "";
            foreach (Position p in positions)
            {
                if (p.SkillLevels.Contains(levelInSkill))
                {
                    className += "pos" + p.PositionId;
                    break;
                }
            }
            if (levelInSkill.SkillLevelId == levelInMatrix.SkillLevelId)
            {
                className += "emp";
            }
            <div class="@className">
                @levelInSkill.Name
            </div>
}
                }
            </div>
        </div>
                    }
                }
        </div>
</body>
</html>
